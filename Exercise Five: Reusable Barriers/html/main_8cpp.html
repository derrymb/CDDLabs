<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Lab 5 Reusable Barriers: main.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Lab 5 Reusable Barriers
   </div>
   <div id="projectbrief">Implement a reusable barrier class</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('main_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">main.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_barrier_8h_source.html">Barrier.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_semaphore_8h_source.html">Semaphore.h</a>&quot;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
</div>
<p><a href="main_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Reusable Barriers</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrp72bbfd61da425602ae9859ded07f46d0"></a>Uses C++11 features such as mutex and condition variables to implement Semaphores in thread functions Example of how to achieve mutual exclusion achieved with a semaphore </p>
</td></tr>
<tr class="memitem:ad3f00e00e4228903dbc3307bed24e0fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#ad3f00e00e4228903dbc3307bed24e0fa">barrierCount</a></td></tr>
<tr class="separator:ad3f00e00e4228903dbc3307bed24e0fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8699d5ff27b11cd94c3e2a948c70195e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a8699d5ff27b11cd94c3e2a948c70195e">barrierTask1</a> (std::shared_ptr&lt; <a class="el" href="class_semaphore.html">Semaphore</a> &gt; mutex, std::shared_ptr&lt; <a class="el" href="class_semaphore.html">Semaphore</a> &gt; first, std::shared_ptr&lt; <a class="el" href="class_semaphore.html">Semaphore</a> &gt; second, int numThread)</td></tr>
<tr class="memdesc:a8699d5ff27b11cd94c3e2a948c70195e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function will have a given number of threads (num_threads) enter and all threads will print out their number and wait until all have arrived before each print out a "B" and then loop around and do it again.  <a href="main_8cpp.html#a8699d5ff27b11cd94c3e2a948c70195e">More...</a><br /></td></tr>
<tr class="separator:a8699d5ff27b11cd94c3e2a948c70195e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd48ef61d965767341cd126b0dcb9e9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#acd48ef61d965767341cd126b0dcb9e9d">barrierTask2</a> (std::shared_ptr&lt; <a class="el" href="class_barrier.html">Barrier</a> &gt; theBarrier, int numLoops)</td></tr>
<tr class="memdesc:acd48ef61d965767341cd126b0dcb9e9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function will have a given number of threads (num_threads) enter and all threads will print out their number and wait until all have arrived before each print out a "B" and then loop around and do it again.  <a href="main_8cpp.html#acd48ef61d965767341cd126b0dcb9e9d">More...</a><br /></td></tr>
<tr class="separator:acd48ef61d965767341cd126b0dcb9e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="memdesc:a840291bc02cba5474a4cb46a9b9566fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ever famous main function that runs our driver to show off barriers.  <a href="main_8cpp.html#a840291bc02cba5474a4cb46a9b9566fe">More...</a><br /></td></tr>
<tr class="separator:a840291bc02cba5474a4cb46a9b9566fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8699d5ff27b11cd94c3e2a948c70195e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8699d5ff27b11cd94c3e2a948c70195e">&#9670;&nbsp;</a></span>barrierTask1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void barrierTask1 </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="class_semaphore.html">Semaphore</a> &gt;&#160;</td>
          <td class="paramname"><em>mutex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="class_semaphore.html">Semaphore</a> &gt;&#160;</td>
          <td class="paramname"><em>first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="class_semaphore.html">Semaphore</a> &gt;&#160;</td>
          <td class="paramname"><em>second</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numThread</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function will have a given number of threads (num_threads) enter and all threads will print out their number and wait until all have arrived before each print out a "B" and then loop around and do it again. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mutex</td><td>a mutex lock used to restrict access to critical section of code </td></tr>
    <tr><td class="paramname">first</td><td>the first of 2 Semaphores used in conjunction to form a turnstile effect on the threads, initialized to 0 </td></tr>
    <tr><td class="paramname">second</td><td>the second of 2 Semaphores used in conjunction to form a turnstile effect on the threads, initialized to 1 </td></tr>
    <tr><td class="paramname">numThread</td><td>the unique number assigned to each thread, from 1 to num_threads, used to print to screen</td></tr>
  </table>
  </dd>
</dl>
<p>Each thread enters and prints out its unique number to the screen then using a mutex lock each thread in turn will increment the global variable barrier count and check to see if they are the last thread to this section (if (barrierCount == num_threads)) all other threads but the last thread will wait at the first "first-&gt;Wait()" until the last thread meets the if statments condition (if (barrierCount == num_threads)). The last thread will then signal first and each thread will wake the previous Then we repeat the same steps to see tha last thread to get to the second section with the conditional if (barrierCount == 0) the last thread in here will wake up a sleeping thread and everyone will move on again to the next loop </p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00042">42</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>

</div>
</div>
<a id="acd48ef61d965767341cd126b0dcb9e9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd48ef61d965767341cd126b0dcb9e9d">&#9670;&nbsp;</a></span>barrierTask2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void barrierTask2 </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="class_barrier.html">Barrier</a> &gt;&#160;</td>
          <td class="paramname"><em>theBarrier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numLoops</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function will have a given number of threads (num_threads) enter and all threads will print out their number and wait until all have arrived before each print out a "B" and then loop around and do it again. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">theBarrier</td><td>a reusable barrier to organise a rendezvous between n threads </td></tr>
    <tr><td class="paramname">numLoops</td><td>the number of loops to be performed within this function</td></tr>
  </table>
  </dd>
</dl>
<p>The loop starts and each thread will perform the first task and wait at the first barrier-&gt;wait() call until all threads have done the first part THey will then proceede to to the second part waiting at the second barrier-&gt;wait() for all threads to complete, before any threads move on to a new loop </p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00087">87</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>

</div>
</div>
<a id="a840291bc02cba5474a4cb46a9b9566fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840291bc02cba5474a4cb46a9b9566fe">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The ever famous main function that runs our driver to show off barriers. </p>
<p>We create a vector of threads, size determined by the global variable num_threads Instansiate Semaphores to use in the barrierless function <a class="el" href="main_8cpp.html#a8699d5ff27b11cd94c3e2a948c70195e" title="This function will have a given number of threads (num_threads) enter and all threads will print out ...">barrierTask1()</a> Instansiate a <a class="el" href="class_barrier.html">Barrier</a> to be used in the barrier function <a class="el" href="main_8cpp.html#acd48ef61d965767341cd126b0dcb9e9d" title="This function will have a given number of threads (num_threads) enter and all threads will print out ...">barrierTask2()</a>, it takes the num_threads as an arguement Instansiate a int i to be used as a counter for our threads in <a class="el" href="main_8cpp.html#a8699d5ff27b11cd94c3e2a948c70195e" title="This function will have a given number of threads (num_threads) enter and all threads will print out ...">barrierTask1()</a> and a int barrierCount to keep track of our threads in <a class="el" href="main_8cpp.html#a8699d5ff27b11cd94c3e2a948c70195e" title="This function will have a given number of threads (num_threads) enter and all threads will print out ...">barrierTask1()</a> also First loop runs the <a class="el" href="main_8cpp.html#a8699d5ff27b11cd94c3e2a948c70195e" title="This function will have a given number of threads (num_threads) enter and all threads will print out ...">barrierTask1()</a> with the provided semaphores and int i on all the threads in our vector of threads and joins threads together once it finishes Second loop uses the same vector of threads to run <a class="el" href="main_8cpp.html#acd48ef61d965767341cd126b0dcb9e9d" title="This function will have a given number of threads (num_threads) enter and all threads will print out ...">barrierTask2()</a> that takes the aBarrier as its <a class="el" href="class_barrier.html">Barrier</a> and an integer for how many times the function will loop and joins the threads together once finished </p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00114">114</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad3f00e00e4228903dbc3307bed24e0fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3f00e00e4228903dbc3307bed24e0fa">&#9670;&nbsp;</a></span>barrierCount</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int barrierCount</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00023">23</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="main_8cpp.html">main.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
